<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Documentación - Generación de Formularios con Apps Script</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f4f4f4;
        }
        .container {
            max-width: 900px;
            margin: auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        h1, h2 {
            color: #333;
        }
        pre {
            background: #eee;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
        }
        .section {
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Documentación del Código - Generación de Formularios con Apps Script</h1>
        
        <div class="section">
            <h2>Descripción General</h2>
            <p>Este script de Google Apps Script permite la creación y modificación de formularios de Google Forms basados en datos de una hoja de cálculo en Google Sheets.</p>
        </div>
        
        <div class="section">
            <h2>Función Principal</h2>
            <p><strong>updateExistingFormV2(formId, spreadsheetId)</strong></p>
            <p>Esta función abre un formulario de Google Forms y una hoja de cálculo de Google Sheets, luego actualiza el formulario con las secciones y preguntas necesarias.</p>
            <pre>
function updateExistingFormV2(formId, spreadsheetId) {
    var form = FormApp.openById(formId);
    var sheet = SpreadsheetApp.openById(spreadsheetId).getSheetByName('Validaciones');
    var data = sheet.getRange('A2:P').getValues();
    
    form.setTitle('COTIZADOR CELSIA 2.0');
    form.setDescription('Este cotizador cuenta con un alcance de ofertas EPC entre 5kWp y 130kWp.');
    
    addBasicInfo(form);
    addCommercialInfo(form, data);
    addClientInfo(form);
    addTechnicalClientInfo(form, data);
    addTechnicalInfo(form, data);
    addAdjustments(form);
    addInverterInfo(form, data);
}
            </pre>
        </div>

        <div class="section">
            <h2>Funciones Auxiliares</h2>
            <p><strong>addBasicInfo(form)</strong>: Agrega preguntas básicas como correo y contraseña.</p>
            <p><strong>addCommercialInfo(form, data)</strong>: Agrega información comercial desde la hoja de cálculo.</p>
            <p><strong>addClientInfo(form)</strong>: Agrega información del cliente.</p>
            <p><strong>addTechnicalClientInfo(form, data)</strong>: Agrega preguntas técnicas del cliente.</p>
            <p><strong>addTechnicalInfo(form, data)</strong>: Agrega preguntas técnicas generales.</p>
            <p><strong>addAdjustments(form)</strong>: Agrega ajustes al formulario.</p>
            <p><strong>addInverterInfo(form, data)</strong>: Agrega información sobre inversores.</p>
        </div>
    </div>
</body>
</html>
